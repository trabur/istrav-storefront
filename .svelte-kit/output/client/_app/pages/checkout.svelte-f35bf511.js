import{S as a,i as e,s,e as t,t as o,k as c,c as l,a as i,g as r,d as n,n as d,b as u,f as p,H as h,h as f,F as y,z as g}from"../chunks/vendor-ebfb1990.js";import{a as b,s as k}from"../chunks/api-3c9fd495.js";function v(a){let e,s,g,b,k,v,m;return{c(){e=t("div"),s=t("h3"),g=o("Finalizing cart,"),b=c(),k=t("h4"),v=o("Let's proceed to checkout now... "),m=o(a[0]),this.h()},l(t){e=l(t,"DIV",{class:!0});var o=i(e);s=l(o,"H3",{});var c=i(s);g=r(c,"Finalizing cart,"),c.forEach(n),b=d(o),k=l(o,"H4",{});var u=i(k);v=r(u,"Let's proceed to checkout now... "),m=r(u,a[0]),u.forEach(n),o.forEach(n),this.h()},h(){u(e,"class","middle svelte-s8voy5")},m(a,t){p(a,e,t),h(e,s),h(s,g),h(e,b),h(e,k),h(k,v),h(k,m)},p(a,[e]){1&e&&f(m,a[0])},i:y,o:y,d(a){a&&n(e)}}}function m(a,e,s){let t;b.subscribe((a=>{t=a,console.log(t)}));let o,c=3,l=null;return g((async()=>{if(l=localStorage.getItem("token"),!t.id)return;let a,e=await k.account.carts.getAll(t.id,l);if(console.log("esCarts",e),!0===e.payload.success){let a=e.payload.data[0].id,s=await k.account.carts.getOne(t.id,l,a);console.log("esCart",s),!0===s.payload.success?o=s.payload.data:alert(s.payload.reason)}else alert(e.payload.reason);let i=await k.account.carts.getStripeCheckoutSession(t.id,l,o.id);if(console.log("esCheckoutSession",i),!0===i.payload.success){let e;a=i.payload.data.id,e=t.isStripeTestData?new Stripe(t.stripePublishableKeyTest):new Stripe(t.stripePublishableKeyLive),setTimeout((()=>{e.redirectToCheckout({sessionId:a})}),3e3),setInterval((()=>{s(0,c-=1)}),1e3)}else alert(i.payload.reason)})),[c]}export default class extends a{constructor(a){super(),e(this,a,m,v,s,{})}}
